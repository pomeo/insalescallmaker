{"version":3,"sources":["components/lightbox.js"],"names":["addon","component","window","UIkit","define","amd","UI","getModal","lightbox","modal","$","Math","abs","innerHeight","join","appendTo","dialog","find","content","loader","closer","on","e","type","preventDefault","this","is","html","$win","Utils","debounce","fitSize","bind","cache","defaults","group","duration","keyboard","index","items","boot","$html","link","data","options","attr","show","$doc","keyCode","previous","next","init","siblings","element","length","domSiblings","each","ele","push","source","title","trigger","stop","item","$this","promise","Deferred","forEach","s","idx","meta","width","height","empty","css","removeClass","done","fail","alert","pad","outerWidth","dpadTop","parseInt","dpadBot","dpad","maxwidth","maxheight","tmp","opacity","position","top","left","max-width","padding","margin","w","h","remove","append","outerHeight","floor","ceil","dh","t","addClass","animate","mwidth","mheight","plugin","match","resolve","img","Image","onerror","reject","onload","src","youtubeRegExp","youtubeRegExpShort","id","matches","stopImmediatePropagation","regex","ajax","url","encodeURI","jsonp","dataType","success","vid","idle","setInterval","videoWidth","clearInterval","videoHeight","create","o","extend"],"mappings":"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","file":"components/lightbox.js","sourcesContent":["/*! UIkit 2.17.0 | http://www.getuikit.com | (c) 2014 YOOtheme | MIT License */\n(function(addon) {\n\n    var component;\n\n    if (window.UIkit) {\n        component = addon(UIkit);\n    }\n\n    if (typeof define == \"function\" && define.amd) { // AMD\n        define([\"uikit-lightbox\"], function(){\n            return component || addon(UIkit);\n        });\n    }\n\n})(function(UI){\n\n    \"use strict\";\n\n    var modal, cache = {};\n\n    UI.component('lightbox', {\n\n        defaults: {\n            \"group\"      : false,\n            \"duration\"   : 400,\n            \"keyboard\"   : true\n        },\n\n        index : 0,\n        items : false,\n\n        boot: function() {\n\n            UI.$html.on('click', '[data-uk-lightbox]', function(e){\n\n                e.preventDefault();\n\n                var link = UI.$(this);\n\n                if (!link.data(\"lightbox\")) {\n\n                    UI.lightbox(link, UI.Utils.options(link.attr(\"data-uk-lightbox\")));\n                }\n\n                link.data(\"lightbox\").show(link);\n            });\n\n            // keyboard navigation\n            UI.$doc.on('keyup', function(e) {\n\n                if (modal && modal.is(':visible') && modal.lightbox.options.keyboard) {\n\n                    e.preventDefault();\n\n                    switch(e.keyCode) {\n                        case 37:\n                            modal.lightbox.previous();\n                            break;\n                        case 39:\n                            modal.lightbox.next();\n                            break;\n                    }\n                }\n            });\n        },\n\n        init: function() {\n\n            var $this = this, siblings = [];\n\n            this.index    = 0;\n            this.siblings = [];\n\n            if (this.element && this.element.length) {\n\n                var domSiblings  = this.options.group ? UI.$([\n                    '[data-uk-lightbox*=\"'+this.options.group+'\"]',\n                    \"[data-uk-lightbox*='\"+this.options.group+\"']\"\n                ].join(',')) : this.element;\n\n                domSiblings.each(function() {\n\n                    var ele = UI.$(this);\n\n                    siblings.push({\n                        'source': ele.attr('href'),\n                        'title' : ele.attr('title'),\n                        'type'  : ele.attr(\"data-lightbox-type\") || 'auto',\n                        'link'  : ele\n                    });\n                });\n\n                this.index    = domSiblings.index(this.element);\n                this.siblings = siblings;\n\n            } else if (this.options.group && this.options.group.length) {\n                this.siblings = this.options.group;\n            }\n\n            this.trigger('lightbox-init', [this]);\n        },\n\n        show: function(index) {\n\n            this.modal = getModal(this);\n\n            // stop previous animation\n            this.modal.dialog.stop();\n            this.modal.content.stop();\n\n            var $this = this, promise = UI.$.Deferred(), data, item;\n\n            index = index || 0;\n\n            // index is a jQuery object or DOM element\n            if (typeof(index) == 'object') {\n\n                this.siblings.forEach(function(s, idx){\n\n                    if (index[0] === s.link[0]) {\n                        index = idx;\n                    }\n                });\n            }\n\n            // fix index if needed\n            if ( index < 0 ) {\n                index = this.siblings.length - index;\n            } else if (!this.siblings[index]) {\n                index = 0;\n            }\n\n            item   = this.siblings[index];\n\n            data = {\n                \"lightbox\" : $this,\n                \"source\"   : item.source,\n                \"type\"     : item.type,\n                \"index\"    : index,\n                \"promise\"  : promise,\n                \"title\"    : item.title,\n                \"item\"     : item,\n                \"meta\"     : {\n                    \"content\" : '',\n                    \"width\"   : null,\n                    \"height\"  : null\n                }\n            };\n\n            this.index = index;\n\n            this.modal.content.empty();\n\n            if (!this.modal.is(':visible')) {\n                this.modal.content.css({width:'', height:''}).empty();\n                this.modal.modal.show();\n            }\n\n            this.modal.loader.removeClass('uk-hidden');\n\n            promise.promise().done(function() {\n\n                $this.data = data;\n                $this.fitSize(data);\n\n            }).fail(function(){\n                alert('Loading resource failed!');\n            });\n\n            $this.trigger('showitem.uk.lightbox', [data]);\n        },\n\n        fitSize: function() {\n\n            var $this    = this,\n                data     = this.data,\n                pad      = this.modal.dialog.outerWidth() - this.modal.dialog.width(),\n                dpadTop  = parseInt(this.modal.dialog.css('margin-top'), 10),\n                dpadBot  = parseInt(this.modal.dialog.css('margin-bottom'), 10),\n                dpad     = dpadTop + dpadBot,\n                content  = data.meta.content,\n                duration = $this.options.duration;\n\n            if (this.siblings.length > 1) {\n\n                content = [\n                    content,\n                    '<a href=\"#\" class=\"uk-slidenav uk-slidenav-contrast uk-slidenav-previous uk-hidden-touch\" data-lightbox-previous></a>',\n                    '<a href=\"#\" class=\"uk-slidenav uk-slidenav-contrast uk-slidenav-next uk-hidden-touch\" data-lightbox-next></a>'\n                ].join('');\n            }\n\n            // calculate width\n            var tmp = UI.$('<div>&nbsp;</div>').css({\n                'opacity'   : 0,\n                'position'  : 'absolute',\n                'top'       : 0,\n                'left'      : 0,\n                'width'     : '100%',\n                'max-width' : $this.modal.dialog.css('max-width'),\n                'padding'   : $this.modal.dialog.css('padding'),\n                'margin'    : $this.modal.dialog.css('margin')\n            }), maxwidth, maxheight, w = data.meta.width, h = data.meta.height;\n\n            tmp.appendTo('body').width();\n\n            maxwidth  = tmp.width();\n            maxheight = window.innerHeight - dpad;\n\n            tmp.remove();\n\n            this.modal.dialog.find('.uk-modal-caption').remove();\n\n            if (data.title) {\n                this.modal.dialog.append('<div class=\"uk-modal-caption\">'+data.title+'</div>');\n                maxheight -= this.modal.dialog.find('.uk-modal-caption').outerHeight();\n            }\n\n            if (maxwidth < data.meta.width) {\n\n                h = Math.floor( h * (maxwidth / w) );\n                w = maxwidth;\n            }\n\n            if (maxheight < h) {\n\n                h = Math.floor(maxheight);\n                w = Math.ceil(data.meta.width * (maxheight/data.meta.height));\n            }\n\n            this.modal.content.css('opacity', 0).width(w).html(content);\n\n            if (data.type == 'iframe') {\n                this.modal.content.find('iframe:first').height(h);\n            }\n\n            var dh   = h + pad,\n                t    = Math.floor(window.innerHeight/2 - dh/2) - dpad;\n\n            if (t < 0) { t = 0; }\n\n            this.modal.closer.addClass('uk-hidden');\n\n            if ($this.modal.data('mwidth') == w &&  $this.modal.data('mheight') == h) {\n                duration = 0;\n            }\n\n            this.modal.dialog.animate({width: w + pad, height: h + pad, top: t }, duration, 'swing', function() {\n                $this.modal.loader.addClass('uk-hidden');\n                $this.modal.content.css({width:''}).animate({'opacity': 1}, function() {\n                    $this.modal.closer.removeClass('uk-hidden');\n                });\n\n                $this.modal.data({'mwidth': w, 'mheight': h});\n            });\n        },\n\n        next: function() {\n            this.show(this.siblings[(this.index+1)] ? (this.index+1) : 0);\n        },\n\n        previous: function() {\n            this.show(this.siblings[(this.index-1)] ? (this.index-1) : this.siblings.length-1);\n        }\n    });\n\n\n    // Plugins\n\n    UI.plugin('lightbox', 'image', {\n\n        init: function(lightbox) {\n\n            lightbox.on(\"showitem.uk.lightbox\", function(e, data){\n\n                if (data.type == 'image' || data.source && data.source.match(/\\.(jpg|jpeg|png|gif|svg)$/)) {\n\n                    var resolve = function(source, width, height) {\n\n                        data.meta = {\n                            \"content\" : '<img class=\"uk-responsive-width\" width=\"'+width+'\" height=\"'+height+'\" src =\"'+source+'\">',\n                            \"width\"   : width,\n                            \"height\"  : height\n                        };\n\n                        data.type = 'image';\n\n                        data.promise.resolve();\n                    };\n\n                    if (!cache[data.source]) {\n\n                        var img = new Image();\n\n                        img.onerror = function(){\n                            data.promise.reject('Loading image failed');\n                        };\n\n                        img.onload = function(){\n                            cache[data.source] = {width: img.width, height: img.height};\n                            resolve(data.source, cache[data.source].width, cache[data.source].height);\n                        };\n\n                        img.src = data.source;\n\n                    } else {\n                        resolve(data.source, cache[data.source].width, cache[data.source].height);\n                    }\n                }\n            });\n        }\n    });\n\n    UI.plugin(\"lightbox\", \"youtube\", {\n\n        init: function(lightbox) {\n\n            var youtubeRegExp = /(\\/\\/.*?youtube\\.[a-z]+)\\/watch\\?v=([^&]+)&?(.*)/,\n                youtubeRegExpShort = /youtu\\.be\\/(.*)/;\n\n\n            lightbox.on(\"showitem.uk.lightbox\", function(e, data){\n\n                var id, matches, resolve = function(id, width, height) {\n\n                    data.meta = {\n                        'content': '<iframe src=\"//www.youtube.com/embed/'+id+'\" width=\"'+width+'\" height=\"'+height+'\" style=\"max-width:100%;\"></iframe>',\n                        'width': width,\n                        'height': height\n                    };\n\n                    data.type = 'iframe';\n\n                    data.promise.resolve();\n                };\n\n                if (matches = data.source.match(youtubeRegExp)) {\n                    id = matches[2];\n                }\n\n                if (matches = data.source.match(youtubeRegExpShort)) {\n                    id = matches[1];\n                }\n\n                if (id) {\n\n                    if(!cache[id]) {\n\n                        var img = new Image();\n\n                        img.onerror = function(){\n                            cache[id] = {width:640, height:320};\n                            resolve(id, cache[id].width, cache[id].height);\n                        };\n\n                        img.onload = function(){\n                            cache[id] = {width:img.width, height:img.height};\n                            resolve(id, img.width, img.height);\n                        };\n\n                        img.src = '//img.youtube.com/vi/'+id+'/0.jpg';\n\n                    } else {\n                        resolve(id, cache[id].width, cache[id].height);\n                    }\n\n                    e.stopImmediatePropagation();\n                }\n            });\n        }\n    });\n\n\n    UI.plugin(\"lightbox\", \"vimeo\", {\n\n        init: function(lightbox) {\n\n            var regex = /(\\/\\/.*?)vimeo\\.[a-z]+\\/([0-9]+).*?/, matches;\n\n\n            lightbox.on(\"showitem.uk.lightbox\", function(e, data){\n\n                var id, resolve = function(id, width, height) {\n\n                    data.meta = {\n                        'content': '<iframe src=\"//player.vimeo.com/video/'+id+'\" width=\"'+width+'\" height=\"'+height+'\" style=\"width:100%;box-sizing:border-box;\"></iframe>',\n                        'width': width,\n                        'height': height\n                    };\n\n                    data.type = 'iframe';\n\n                    data.promise.resolve();\n                };\n\n                if (matches = data.source.match(regex)) {\n\n                    id = matches[2];\n\n                    if(!cache[id]) {\n\n                        UI.$.ajax({\n                            type     : 'GET',\n                            url      : 'http://vimeo.com/api/oembed.json?url=' + encodeURI(data.source),\n                            jsonp    : 'callback',\n                            dataType : 'jsonp',\n                            success  : function(data) {\n                                cache[id] = {width:data.width, height:data.height};\n                                resolve(id, cache[id].width, cache[id].height);\n                            }\n                        });\n\n                    } else {\n                        resolve(id, cache[id].width, cache[id].height);\n                    }\n\n                    e.stopImmediatePropagation();\n                }\n            });\n        }\n    });\n\n    UI.plugin(\"lightbox\", \"video\", {\n\n        init: function(lightbox) {\n\n            lightbox.on(\"showitem.uk.lightbox\", function(e, data){\n\n                var resolve = function(source, width, height) {\n\n                    data.meta = {\n                        'content': '<video class=\"uk-responsive-width\" src=\"'+source+'\" width=\"'+width+'\" height=\"'+height+'\" controls></video>',\n                        'width': width,\n                        'height': height\n                    };\n\n                    data.type = 'video';\n\n                    data.promise.resolve();\n                };\n\n                if (data.type == 'video' || data.source.match(/\\.(mp4|webm|ogv)$/)) {\n\n                    if (!cache[data.source]) {\n\n                        var vid = UI.$('<video style=\"position:fixed;visibility:hidden;top:-10000px;\"></video>').attr('src', data.source).appendTo('body');\n\n                        var idle = setInterval(function() {\n\n                            if (vid[0].videoWidth) {\n                                clearInterval(idle);\n                                cache[data.source] = {width: vid[0].videoWidth, height: vid[0].videoHeight};\n                                resolve(data.source, cache[data.source].width, cache[data.source].height);\n                                vid.remove();\n                            }\n\n                        }, 20);\n\n                    } else {\n                        resolve(data.source, cache[data.source].width, cache[data.source].height);\n                    }\n                }\n            });\n        }\n    });\n\n\n    function getModal(lightbox) {\n\n        if (modal) {\n            modal.lightbox = lightbox;\n            return modal;\n        }\n\n        // init lightbox container\n        modal = UI.$([\n            '<div class=\"uk-modal\">',\n                '<div class=\"uk-modal-dialog uk-modal-dialog-lightbox uk-slidenav-position\" style=\"margin-left:auto;margin-right:auto;width:200px;height:200px;top:'+Math.abs(window.innerHeight/2 - 200)+'px;\">',\n                    '<a href=\"#\" class=\"uk-modal-close uk-close uk-close-alt\"></a>',\n                    '<div class=\"uk-lightbox-content\"></div>',\n                    '<div class=\"uk-modal-spinner uk-hidden\"></div>',\n                '</div>',\n            '</div>'\n        ].join('')).appendTo('body');\n\n        modal.dialog  = modal.find('.uk-modal-dialog:first');\n        modal.content = modal.find('.uk-lightbox-content:first');\n        modal.loader  = modal.find('.uk-modal-spinner:first');\n        modal.closer  = modal.find('.uk-close.uk-close-alt');\n        modal.modal   = UI.modal(modal);\n\n        // next / previous\n        modal.on(\"swipeRight swipeLeft\", function(e) {\n            modal.lightbox[e.type=='swipeLeft' ? 'next':'previous']();\n        }).on(\"click\", \"[data-lightbox-previous], [data-lightbox-next]\", function(e){\n            e.preventDefault();\n            modal.lightbox[UI.$(this).is('[data-lightbox-next]') ? 'next':'previous']();\n        });\n\n        // destroy content on modal hide\n        modal.on(\"hide.uk.modal\", function(e) {\n            modal.content.html('');\n        });\n\n        UI.$win.on('load resize orientationchange', UI.Utils.debounce(function(){\n            if (modal.is(':visible')) modal.lightbox.fitSize();\n        }.bind(this), 100));\n\n        modal.lightbox = lightbox;\n\n        return modal;\n    }\n\n    UI.lightbox.create = function(items, options) {\n\n        if (!items) return;\n\n        var group = [], o;\n\n        items.forEach(function(item) {\n\n            group.push(UI.$.extend({\n                'source' : '',\n                'title'  : '',\n                'type'   : 'auto',\n                'link'   : false\n            }, (typeof(item) == 'string' ? {'source': item} : item)));\n        });\n\n        o = UI.lightbox(UI.$.extend({}, options, {'group':group}));\n\n        return o;\n    };\n\n    return UI.lightbox;\n});\n"],"sourceRoot":"/source/"}